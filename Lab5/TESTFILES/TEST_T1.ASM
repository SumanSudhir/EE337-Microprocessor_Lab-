ORG 00H
LJMP MAIN

DELAY_T1:
	USING 0
		PUSH ACC
		PUSH AR0
		MOV R0,#71H         ;INDIRECT READ FROM MEMORY LOCATION 81H
		MOV A,@R0
		CPL A    			;COMPLEMENT OF A
		ADD A,#01    		;ADD 1 TO MAKE IT 2'S COMPLEMENT
		MOV TL1,A
		INC R0              ;CARRY FLAG IS NOT AFFECTED BY INC
		MOV A,@R0
		CPL A               ;COMPLEMENT OF ANOTHER BYTE
		ADDC A,#00H         ;WILL ADD CARRY IF GENERATED FROM LOWER BYTE
		MOV TH1,A
						;2'S COMPLEMENT OF THE 16BIT NO. IS NOW STORED IN T0
		;MOV TMOD,#11H
		SETB TR1             ;ENABLE TIMER 0
		
		POP AR0
		POP ACC
RET


DELAY:
		USING 0
		PUSH ACC
		PUSH AR0
		MOV R0,#81H         ;INDIRECT READ FROM MEMORY LOCATION 81H
		MOV A,@R0
		CPL A    			;COMPLEMENT OF A
		ADD A,#01    		;ADD 1 TO MAKE IT 2'S COMPLEMENT
		MOV TL0,A
		INC R0              ;CARRY FLAG IS NOT AFFECTED BY INC
		MOV A,@R0
		CPL A               ;COMPLEMENT OF ANOTHER BYTE
		ADDC A,#00H         ;WILL ADD CARRY IF GENERATED FROM LOWER BYTE
		MOV TH0,A
						;2'S COMPLEMENT OF THE 16BIT NO. IS NOW STORED IN T0
		;MOV TMOD,#11H
		SETB TR0             ;ENABLE TIMER 0
START_COUNT:
		JNB TF0,START_COUNT    ;Jump if Bit Not Set
		CLR TR0              	;STOP TIMER
		CLR TF0              	;CLEAR OVERFLOW BIT
		POP AR0
		POP ACC
RET



MAIN:

	MOV 71H,#0FFH
	MOV 72H,#0FFH
	MOV 81H,#47H				
	MOV 82H,#10H  
	MOV TMOD,#11H
	LCALL DELAY_T1
  ;LOOP:
	FREQ:
		SETB P0.3
		LCALL DELAY
		CPL P0.3
		LCALL DELAY
			JNB TF1,FREQ
			CLR TR1
			CLR TF1
			;SJMP LOOP
END
			


