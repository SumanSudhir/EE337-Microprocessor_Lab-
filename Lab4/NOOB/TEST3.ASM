
LED EQU P1
ORG 00H
LJMP MAIN
ORG 100H

DELAY1:
	USING 0
	PUSH AR1
	PUSH AR2
	PUSH AR3
	PUSH PSW

	MOV R3,A
LOOP:
	MOV R2,#200
	BACK1:
	MOV R1,#0FFH
	BACK :
	DJNZ R1, BACK
	DJNZ R2, BACK1
	DJNZ R3,LOOP
	
	POP PSW
	POP AR3
	POP AR2
	POP AR1
RET

LOADING_A:
	;MOV P1,#0F0H    ;LED HIGH
	
	;MOV A,#100       ;DELAY OF 5S 
	;LCALL DELAY1
	
	;CLR P1.7
	;CLR P1.6 
	;CLR P1.5
	;CLR P1.4
	
	;MOV A,#20
	;LCALL DELAY1         ;DELAY OF 1S
	
	MOV A,P1
RET
READNIBBLE:
	;LCALL LOADING_A
	
	MOV P1,#0FFH 
	MOV A,#60
	LCALL DELAY1   
	
	MOV A,P1
	MOV @R0,A
	SWAP A
	MOV P1,A   ;will show input on led
	
	MOV A,#60
	LCALL DELAY1   ;wait for 5 sec

	CLR P1.7
	CLR P1.6 
	CLR P1.5
	CLR P1.4
	
	;LCALL LOADING_A       ;VERIFY   ;give input 0fh to verify
	;CJNE A,#0FH,READNIBBLE

RET

PACKNIBBLE:
	MOV A, 4EH
	SWAP A
	ADD A, 4FH
RET

READVALUES:
	MOV R1,51H
	MOV R2,#2
	
	STORE:
		MOV R0, #4EH
		LCALL READNIBBLE
		MOV R0, #4FH
		LCALL READNIBBLE
		LCALL PACKNIBBLE
		MOV @R1,A
		INC R1
		DJNZ R2,STORE
RET


MAIN:
	ACALL READVALUES
	HERE:SJMP HERE
END
